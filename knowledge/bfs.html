<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº¤äº’å¼ BFS ç®—æ³•å­¦ä¹ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Chosen Palette: Calm Harmony */
        /* Application Structure Plan: The application is structured as a single-page, multi-section interactive module. This design breaks down the complex topic of BFS into digestible parts: Introduction, Core Concepts, a central Interactive Visualization, and finally Applications/Analysis. This step-by-step, tab-based navigation is chosen over a long scroll because it creates a structured, guided learning path, reducing cognitive load and allowing users to focus on one concept at a time. The interactive visualization is the centerpiece, designed to turn abstract steps into a concrete, controllable process, which is the most effective way to teach an algorithm. */
        /* Visualization & Content Choices: Report Info: BFS algorithm steps. -> Goal: Teach the process. -> Viz/Presentation: Interactive graph visualization using HTML divs for nodes/edges, and dynamic divs for Queue/Visited sets. -> Interaction: User-controlled "Next Step" and "Reset" buttons to walk through the algorithm. -> Justification: This direct manipulation and visualization is far more effective for learning than static text or diagrams. It clarifies how data structures (Queue, Visited) change in real-time. -> Library/Method: Vanilla JavaScript for logic, Tailwind CSS for layout and styling. This approach avoids external libraries like SVG or Mermaid, keeping the app lightweight and demonstrating that complex visualizations can be achieved with standard web technologies. */
        /* CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. */
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
            background-color: #f8fafc; /* slate-50 */
        }
        .nav-btn {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
        }
        .nav-btn.active {
            border-bottom-color: #4f46e5; /* indigo-600 */
            color: #4f46e5;
        }
        .graph-node {
            position: absolute;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1e293b; /* slate-800 */
            background-color: #ffffff;
            border: 2px solid #cbd5e1; /* slate-300 */
            transition: all 0.3s ease;
            z-index: 10;
        }
        .graph-node.visited {
            background-color: #dcfce7; /* green-100 */
            border-color: #22c55e; /* green-500 */
        }
        .graph-node.current {
            border-color: #facc15; /* yellow-400 */
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(250, 204, 21, 0.7);
        }
        .graph-edge {
            position: absolute;
            height: 2px;
            background-color: #94a3b8; /* slate-400 */
            transform-origin: 0 0;
            z-index: 5;
        }
        .status-box {
            min-height: 50px;
            background-color: #f1f5f9; /* slate-100 */
        }
        .log-message {
            border-left: 3px solid #64748b; /* slate-500 */
        }
        .code-block {
            background-color: #1e293b; /* slate-800 */
            color: #e2e8f0; /* slate-200 */
            padding: 1.5rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            font-family: 'Fira Code', 'Courier New', monospace;
            font-size: 0.875rem;
        }
        .code-keyword { color: #818cf8; } /* indigo-400 */
        .code-type { color: #7dd3fc; } /* sky-300 */
        .code-comment { color: #64748b; } /* slate-500 */
        .code-string { color: #a5b4fc; } /* indigo-300 */
        .code-preprocessor { color: #f87171; } /* red-400 */
        .code-function { color: #a78bfa; } /* violet-400 */
    </style>
</head>
<body class="text-slate-700">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-slate-800">å¹¿åº¦ä¼˜å…ˆæœç´¢ (BFS) äº¤äº’å¼å­¦ä¹ </h1>
            <p class="mt-2 text-lg text-slate-500">ä¸€ä¸ªå°†æŠ½è±¡ç®—æ³•å˜å¾—å…·ä½“å¯è§†çš„æŒ‡å—</p>
        </header>

        <nav class="flex justify-center border-b border-slate-200 mb-8">
            <button class="nav-btn active px-4 py-2 text-lg font-medium text-slate-500" onclick="showSection('intro')">ä»‹ç»</button>
            <button class="nav-btn px-4 py-2 text-lg font-medium text-slate-500" onclick="showSection('visualizer')">ç®—æ³•å¯è§†åŒ–ä¸ä»£ç </button>
            <button class="nav-btn px-4 py-2 text-lg font-medium text-slate-500" onclick="showSection('details')">æ ¸å¿ƒä¸åº”ç”¨</button>
        </nav>

        <main>
            <section id="intro">
                <div class="bg-white p-6 md:p-8 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">ä»€ä¹ˆæ˜¯å¹¿åº¦ä¼˜å…ˆæœç´¢ (BFS)ï¼Ÿ</h2>
                    <p class="mb-4 text-base leading-relaxed">
                        å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰æ˜¯ä¸€ç§ç”¨äºéå†æˆ–æœç´¢æ ‘æˆ–å›¾çš„ç®—æ³•ã€‚å®ƒä»ä¸€ä¸ªèµ·å§‹èŠ‚ç‚¹ï¼ˆæ ¹èŠ‚ç‚¹ï¼‰å¼€å§‹ï¼Œé¦–å…ˆæ¢ç´¢å®Œæ‰€æœ‰ä¸èµ·å§‹èŠ‚ç‚¹ç›´æ¥ç›¸è¿çš„é‚»å±…èŠ‚ç‚¹ï¼Œç„¶åå†æŒ‰ç…§â€œå…ˆæ¥ååˆ°â€çš„é¡ºåºï¼Œé€ä¸€è®¿é—®è¿™äº›é‚»å±…èŠ‚ç‚¹çš„é‚»å±…èŠ‚ç‚¹ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šä¸€å±‚ä¸€å±‚åœ°å‘å¤–æ‰©å±•ï¼Œç›´åˆ°æ‰¾åˆ°äº†ç›®æ ‡èŠ‚ç‚¹æˆ–è€…éå†å®Œæ‰€æœ‰å¯è¾¾çš„èŠ‚ç‚¹ã€‚
                    </p>
                    <div class="bg-indigo-50 p-4 rounded-lg text-center">
                        <p class="text-indigo-700 font-medium">
                            ğŸ’¡ ä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆåœ¨æ°´é¢ä¸Šæ‰”ä¸€å—çŸ³å¤´ï¼Œæ¿€èµ·çš„æ¶Ÿæ¼ªä¼šä»ä¸­å¿ƒç‚¹å¼€å§‹ï¼Œä¸€åœˆä¸€åœˆåœ°å‘å¤–æ‰©æ•£ã€‚BFS çš„æœç´¢æ–¹å¼å°±å’Œè¿™ä¸ªè¿‡ç¨‹éå¸¸ç›¸ä¼¼ã€‚
                        </p>
                    </div>
                     <p class="mt-6 text-base leading-relaxed">
                        åœ¨æœ¬æŒ‡å—çš„â€œç®—æ³•å¯è§†åŒ–ä¸ä»£ç â€éƒ¨åˆ†ï¼Œä½ å°†èƒ½äº²æ‰‹æ“ä½œå¹¶è§‚å¯Ÿè¿™ä¸€è¿‡ç¨‹ï¼Œå¹¶æŸ¥çœ‹å…¶ C++ å®ç°ã€‚å‡†å¤‡å¥½åï¼Œè¯·ç‚¹å‡»ä¸Šæ–¹å¯¼èˆªæ å¼€å§‹æ¢ç´¢ã€‚
                    </p>
                </div>
            </section>

            <section id="visualizer" class="hidden">
                 <div class="text-center mb-6">
                    <h2 class="text-2xl font-bold text-slate-800">å®æ—¶è§‚å¯Ÿ BFS</h2>
                    <p class="text-slate-500 mt-1">ç‚¹å‡»â€œä¸‹ä¸€æ­¥â€æ¥é€æ­¥æ‰§è¡Œç®—æ³•ï¼Œæˆ–ç‚¹å‡»â€œé‡ç½®â€ä»å¤´å¼€å§‹ã€‚</p>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <div class="lg:col-span-2 bg-white p-4 rounded-lg shadow-sm relative" style="height: 450px;">
                        <div id="graph-container"></div>
                    </div>
                    <div>
                        <div class="bg-white p-4 rounded-lg shadow-sm">
                            <h3 class="font-bold text-lg mb-2 text-slate-800">æ§åˆ¶é¢æ¿</h3>
                            <div class="flex space-x-2 mb-4">
                                <button id="start-btn" class="w-full bg-indigo-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-indigo-700 transition">å¼€å§‹/é‡ç½®</button>
                                <button id="next-step-btn" class="w-full bg-slate-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-slate-700 transition" disabled>ä¸‹ä¸€æ­¥</button>
                            </div>
                            <div class="space-y-4">
                                <div>
                                    <h4 class="font-semibold text-slate-600 mb-1">é˜Ÿåˆ— (Queue):</h4>
                                    <div id="queue-box" class="status-box p-2 rounded-md flex items-center space-x-2 overflow-x-auto"></div>
                                </div>
                                <div>
                                    <h4 class="font-semibold text-slate-600 mb-1">å·²è®¿é—®é›†åˆ (Visited Set):</h4>
                                    <div id="visited-box" class="status-box p-2 rounded-md flex items-center flex-wrap gap-2"></div>
                                </div>
                            </div>
                        </div>
                         <div class="bg-white p-4 rounded-lg shadow-sm mt-4">
                            <h3 class="font-bold text-lg mb-2 text-slate-800">æ‰§è¡Œæ—¥å¿—</h3>
                            <div id="log-box" class="h-32 overflow-y-auto space-y-2 pr-2"></div>
                        </div>
                    </div>
                </div>

                <div class="mt-12">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4 text-center">C++ ä»£ç å®ç°</h2>
                     <div class="code-block">
<pre><code><span class="code-preprocessor">#include &lt;iostream&gt;</span>
<span class="code-preprocessor">#include &lt;vector&gt;</span>
<span class="code-preprocessor">#include &lt;queue&gt;</span>
<span class="code-preprocessor">#include &lt;list&gt;</span>

<span class="code-comment">// ä½¿ç”¨é‚»æ¥è¡¨æ¥è¡¨ç¤ºå›¾çš„ç±»</span>
<span class="code-keyword">class</span> <span class="code-type">Graph</span> {
<span class="code-keyword">private</span>:
    <span class="code-comment">// é¡¶ç‚¹çš„æ•°é‡</span>
    <span class="code-type">int</span> numVertices;
    <span class="code-comment">// é‚»æ¥è¡¨ã€‚adj[i] æ˜¯ä¸€ä¸ªåŒ…å«é¡¶ç‚¹ i æ‰€æœ‰é‚»å±…çš„åˆ—è¡¨ã€‚</span>
    <span class="code-type">std::vector&lt;std::list&lt;int&gt;&gt;</span> adj;

<span class="code-keyword">public</span>:
    <span class="code-comment">// æ„é€ å‡½æ•°ï¼Œç”¨äºåˆå§‹åŒ–å›¾ï¼Œåˆ†é…é¡¶ç‚¹ç©ºé—´</span>
    <span class="code-function">Graph</span>(<span class="code-type">int</span> vertices) {
        numVertices = vertices;
        adj.resize(numVertices);
    }

    <span class="code-comment">// æ·»åŠ ä¸€æ¡ä»é¡¶ç‚¹ v åˆ°é¡¶ç‚¹ w çš„æœ‰å‘è¾¹</span>
    <span class="code-keyword">void</span> <span class="code-function">addEdge</span>(<span class="code-type">int</span> v, <span class="code-type">int</span> w) {
        adj[v].push_back(w);
    }

    <span class="code-comment">// ä»ç»™å®šçš„æºç‚¹ s å¼€å§‹æ‰§è¡Œ BFS éå†</span>
    <span class="code-keyword">void</span> <span class="code-function">BFS</span>(<span class="code-type">int</span> s) {
        <span class="code-comment">// 1. åˆå§‹åŒ–</span>
        <span class="code-type">std::vector&lt;bool&gt;</span> visited(numVertices, <span class="code-keyword">false</span>);
        <span class="code-type">std::queue&lt;int&gt;</span> queue;

        <span class="code-comment">// 2. å¼€å§‹æœç´¢</span>
        visited[s] = <span class="code-keyword">true</span>;
        queue.push(s);

        std::cout &lt;&lt; <span class="code-string">"BFS éå†é¡ºåº: "</span>;

        <span class="code-comment">// 3. å¾ªç¯éå†</span>
        <span class="code-keyword">while</span> (!queue.empty()) {
            <span class="code-type">int</span> u = queue.front();
            std::cout &lt;&lt; u &lt;&lt; <span class="code-string">" "</span>;
            queue.pop();

            <span class="code-comment">// éå†å½“å‰é¡¶ç‚¹ u çš„æ‰€æœ‰é‚»å±…</span>
            <span class="code-keyword">for</span> (<span class="code-type">int</span> v : adj[u]) {
                <span class="code-keyword">if</span> (!visited[v]) {
                    visited[v] = <span class="code-keyword">true</span>;
                    queue.push(v);
                }
            }
        }
        std::cout &lt;&lt; std::endl;
    }
};

<span class="code-comment">// ä¸»å‡½æ•°ï¼Œç¨‹åºçš„å…¥å£</span>
<span class="code-type">int</span> <span class="code-function">main</span>() {
    <span class="code-type">Graph</span> g(6);

    g.addEdge(0, 1);
    g.addEdge(0, 2);
    g.addEdge(1, 3);
    g.addEdge(1, 4);
    g.addEdge(2, 5);
    g.addEdge(4, 5);

    std::cout &lt;&lt; <span class="code-string">"ä»é¡¶ç‚¹ 0 å¼€å§‹è¿›è¡Œå¹¿åº¦ä¼˜å…ˆéå†:"</span> &lt;&lt; std::endl;
    g.BFS(0);

    std::cout &lt;&lt; <span class="code-string">"\nä»é¡¶ç‚¹ 1 å¼€å§‹è¿›è¡Œå¹¿åº¦ä¼˜å…ˆéå†:"</span> &lt;&lt; std::endl;
    g.BFS(1);

    <span class="code-keyword">return</span> 0;
}
</code></pre>
                    </div>
                </div>
            </section>

            <section id="details" class="hidden">
                <div class="space-y-6">
                    <div class="bg-white p-6 md:p-8 rounded-lg shadow-sm">
                        <h2 class="text-2xl font-bold text-slate-800 mb-4">ç®—æ³•æ ¸å¿ƒæ­¥éª¤</h2>
                        <ol class="list-decimal list-inside space-y-3">
                            <li><strong>åˆå§‹åŒ–</strong>: åˆ›å»ºä¸€ä¸ªå…ˆè¿›å…ˆå‡º (FIFO) çš„**é˜Ÿåˆ—**ç”¨äºå­˜æ”¾å¾…è®¿é—®èŠ‚ç‚¹ï¼Œä»¥åŠä¸€ä¸ª**è®¿é—®è®°å½•** (Visited Set) æ¥é¿å…é‡å¤è®¿é—®ã€‚</li>
                            <li><strong>å¼€å§‹æœç´¢</strong>: å°†**èµ·å§‹èŠ‚ç‚¹**æ”¾å…¥é˜Ÿåˆ—ï¼Œå¹¶æ ‡è®°ä¸ºâ€œå·²è®¿é—®â€ã€‚</li>
                            <li><strong>å¾ªç¯éå†</strong>: å½“é˜Ÿåˆ—ä¸ä¸ºç©ºæ—¶ï¼Œä»é˜Ÿåˆ—å¤´éƒ¨å–å‡ºä¸€ä¸ªèŠ‚ç‚¹ `u`ã€‚</li>
                            <li><strong>å¤„ç†é‚»å±…</strong>: éå† `u` çš„æ‰€æœ‰**æœªè¢«è®¿é—®è¿‡**çš„é‚»å±…èŠ‚ç‚¹ `v`ï¼Œå°†å®ƒä»¬æ ‡è®°ä¸ºâ€œå·²è®¿é—®â€å¹¶æ”¾å…¥é˜Ÿåˆ—å°¾éƒ¨ã€‚</li>
                            <li><strong>ç»“æŸ</strong>: å½“é˜Ÿåˆ—ä¸ºç©ºï¼Œæœç´¢ç»“æŸã€‚</li>
                        </ol>
                    </div>

                    <div class="bg-white p-6 md:p-8 rounded-lg shadow-sm">
                        <h2 class="text-2xl font-bold text-slate-800 mb-4">ä¸ºä»€ä¹ˆ BFS èƒ½æ‰¾åˆ°æœ€çŸ­è·¯å¾„ï¼Ÿ</h2>
                        <p class="mb-4">åœ¨**æ— æƒå›¾**ï¼ˆæ‰€æœ‰è¾¹çš„æƒé‡éƒ½ç›¸åŒï¼Œå¯è§†ä¸º1ï¼‰ä¸­ï¼ŒBFS ä¿è¯èƒ½æ‰¾åˆ°ä»èµ·ç‚¹åˆ°ä»»ä½•å…¶ä»–å¯è¾¾èŠ‚ç‚¹çš„æœ€çŸ­è·¯å¾„ã€‚è¿™æ˜¯å› ä¸ºå®ƒæŒ‰å±‚çº§è¿›è¡Œæœç´¢ã€‚ç¬¬ä¸€å±‚æ‰¾åˆ°çš„èŠ‚ç‚¹è·¯å¾„é•¿åº¦ä¸º1ï¼Œç¬¬äºŒå±‚ä¸º2ï¼Œä»¥æ­¤ç±»æ¨ã€‚ç”±äºå®ƒæ˜¯é€å±‚æ‰©å±•çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡åˆ°è¾¾æŸä¸ªç›®æ ‡èŠ‚ç‚¹æ—¶æ‰€ç»è¿‡çš„è·¯å¾„ï¼Œå¿…ç„¶æ˜¯æ‰€æœ‰å¯èƒ½è·¯å¾„ä¸­æœ€çŸ­çš„ä¸€æ¡ã€‚</p>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white p-6 rounded-lg shadow-sm">
                            <h3 class="text-xl font-bold text-slate-800 mb-3">ä¸»è¦åº”ç”¨åœºæ™¯</h3>
                            <ul class="space-y-2">
                                <li class="flex items-start"><span class="mr-2 text-indigo-500">â”</span>æ— æƒå›¾æœ€çŸ­è·¯å¾„é—®é¢˜</li>
                                <li class="flex items-start"><span class="mr-2 text-indigo-500">â”</span>å¯»æ‰¾å›¾çš„è¿é€šåˆ†é‡</li>
                                <li class="flex items-start"><span class="mr-2 text-indigo-500">â”</span>ç½‘ç»œçˆ¬è™«</li>
                                <li class="flex items-start"><span class="mr-2 text-indigo-500">â”</span>æ‹“æ‰‘æ’åº</li>
                                <li class="flex items-start"><span class="mr-2 text-indigo-500">â”</span>è§£å†³è¿·å®«ç­‰è°œé¢˜</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-lg shadow-sm">
                            <h3 class="text-xl font-bold text-slate-800 mb-3">æ—¶ç©ºå¤æ‚åº¦</h3>
                            <div class="space-y-2">
                                <p><strong>æ—¶é—´å¤æ‚åº¦: O(V + E)</strong><br><span class="text-sm text-slate-500">V = é¡¶ç‚¹æ•°, E = è¾¹æ•°ã€‚æ¯ä¸ªé¡¶ç‚¹å’Œæ¯æ¡è¾¹éƒ½åªè®¿é—®ä¸€æ¬¡ã€‚</span></p>
                                <p><strong>ç©ºé—´å¤æ‚åº¦: O(V)</strong><br><span class="text-sm text-slate-500">åœ¨æœ€åæƒ…å†µä¸‹ï¼Œé˜Ÿåˆ—å¯èƒ½éœ€è¦å­˜å‚¨æ‰€æœ‰é¡¶ç‚¹ã€‚</span></p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

    </div>

    <script>
        const sections = ['intro', 'visualizer', 'details'];
        const navButtons = document.querySelectorAll('.nav-btn');
        const sectionElements = {
            intro: document.getElementById('intro'),
            visualizer: document.getElementById('visualizer'),
            details: document.getElementById('details')
        };

        function showSection(sectionId) {
            sections.forEach(id => {
                sectionElements[id].classList.add('hidden');
            });
            sectionElements[sectionId].classList.remove('hidden');

            navButtons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.getAttribute('onclick').includes(`'${sectionId}'`)) {
                    btn.classList.add('active');
                }
            });
        }

        // --- BFS Visualizer Logic ---
        const graphContainer = document.getElementById('graph-container');
        const startBtn = document.getElementById('start-btn');
        const nextStepBtn = document.getElementById('next-step-btn');
        const queueBox = document.getElementById('queue-box');
        const visitedBox = document.getElementById('visited-box');
        const logBox = document.getElementById('log-box');

        const graph = {
            0: [1, 2],
            1: [0, 3, 4],
            2: [0, 5],
            3: [1],
            4: [1, 5],
            5: [2, 4]
        };

        const nodePositions = {
            0: { x: 100, y: 200 },
            1: { x: 250, y: 100 },
            2: { x: 250, y: 300 },
            3: { x: 400, y: 50 },
            4: { x: 400, y: 150 },
            5: { x: 400, y: 250 }
        };

        let queue = [];
        let visited = new Set();
        let currentNode = null;
        let bfsGenerator;
        
        function addLog(message, isImportant = false) {
            const p = document.createElement('p');
            p.textContent = message;
            p.className = 'log-message text-sm p-1 rounded-r-md';
            if(isImportant) p.classList.add('font-semibold', 'text-indigo-700');
            logBox.appendChild(p);
            logBox.scrollTop = logBox.scrollHeight;
        }

        function createNodeElement(id) {
            const node = document.createElement('div');
            node.id = `node-${id}`;
            node.className = 'graph-node';
            node.textContent = id;
            node.style.left = `${nodePositions[id].x}px`;
            node.style.top = `${nodePositions[id].y}px`;
            return node;
        }

        function createEdgeElement(from, to) {
            const pos1 = nodePositions[from];
            const pos2 = nodePositions[to];
            const dx = pos2.x - pos1.x;
            const dy = pos2.y - pos1.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const angle = Math.atan2(dy, dx) * 180 / Math.PI;

            const edge = document.createElement('div');
            edge.className = 'graph-edge';
            edge.style.width = `${distance}px`;
            edge.style.transform = `rotate(${angle}deg)`;
            edge.style.left = `${pos1.x + 25}px`;
            edge.style.top = `${pos1.y + 25}px`;
            return edge;
        }
        
        function drawGraph() {
            graphContainer.innerHTML = '';
            const drawnEdges = new Set();

            Object.keys(graph).forEach(nodeId => {
                graph[nodeId].forEach(neighborId => {
                    const edgeId1 = `${nodeId}-${neighborId}`;
                    const edgeId2 = `${neighborId}-${nodeId}`;
                    if (!drawnEdges.has(edgeId1) && !drawnEdges.has(edgeId2)) {
                        graphContainer.appendChild(createEdgeElement(nodeId, neighborId));
                        drawnEdges.add(edgeId1);
                    }
                });
            });

            Object.keys(graph).forEach(nodeId => {
                graphContainer.appendChild(createNodeElement(nodeId));
            });
        }

        function updateUI() {
            // Update nodes
            Object.keys(graph).forEach(id => {
                const nodeEl = document.getElementById(`node-${id}`);
                nodeEl.classList.remove('current', 'visited');
                if (id == currentNode) {
                    nodeEl.classList.add('current');
                }
                if (visited.has(parseInt(id))) {
                    nodeEl.classList.add('visited');
                }
            });

            // Update queue box
            queueBox.innerHTML = '';
            queue.forEach(id => {
                const nodeEl = document.createElement('div');
                nodeEl.className = 'w-8 h-8 rounded-md bg-white border-2 border-slate-400 flex items-center justify-center font-bold flex-shrink-0';
                nodeEl.textContent = id;
                queueBox.appendChild(nodeEl);
            });
            
            // Update visited box
            visitedBox.innerHTML = '';
            visited.forEach(id => {
                const nodeEl = document.createElement('div');
                nodeEl.className = 'w-8 h-8 rounded-full bg-green-500 text-white flex items-center justify-center font-bold flex-shrink-0';
                nodeEl.textContent = id;
                visitedBox.appendChild(nodeEl);
            });
        }

        function* bfsSteps(startNode) {
            addLog(`--- BFS ä»èŠ‚ç‚¹ ${startNode} å¼€å§‹ ---`, true);
            
            queue.push(startNode);
            visited.add(startNode);
            addLog(`å°†èµ·å§‹èŠ‚ç‚¹ ${startNode} å…¥é˜Ÿå¹¶æ ‡è®°ä¸ºå·²è®¿é—®ã€‚`);
            yield;

            while (queue.length > 0) {
                currentNode = queue.shift();
                addLog(`ä»é˜Ÿåˆ—ä¸­å–å‡ºèŠ‚ç‚¹ ${currentNode}ã€‚`, true);
                yield;

                const neighbors = graph[currentNode];
                addLog(`æ£€æŸ¥èŠ‚ç‚¹ ${currentNode} çš„é‚»å±…: ${neighbors.join(', ')}ã€‚`);
                yield;

                for (const neighbor of neighbors) {
                    if (!visited.has(neighbor)) {
                        visited.add(neighbor);
                        queue.push(neighbor);
                        addLog(`é‚»å±… ${neighbor} æœªè¢«è®¿é—®ï¼Œå°†å…¶å…¥é˜Ÿå¹¶æ ‡è®°ã€‚`);
                        yield;
                    } else {
                         addLog(`é‚»å±… ${neighbor} å·²è¢«è®¿é—®ï¼Œè·³è¿‡ã€‚`);
                         yield;
                    }
                }
                currentNode = null;
            }
            addLog("--- é˜Ÿåˆ—ä¸ºç©ºï¼ŒBFS ç»“æŸ ---", true);
        }

        function reset() {
            queue = [];
            visited.clear();
            currentNode = null;
            logBox.innerHTML = '';
            nextStepBtn.disabled = true;
            drawGraph();
            updateUI();
        }

        startBtn.addEventListener('click', () => {
            reset();
            const startNode = 0;
            bfsGenerator = bfsSteps(startNode);
            nextStepBtn.disabled = false;
            addLog("å¯è§†åŒ–å·²é‡ç½®ï¼Œå‡†å¤‡å¼€å§‹ã€‚");
            updateUI();
        });

        nextStepBtn.addEventListener('click', () => {
            if (bfsGenerator) {
                const result = bfsGenerator.next();
                updateUI();
                if (result.done) {
                    nextStepBtn.disabled = true;
                }
            }
        });

        // Initial setup
        drawGraph();

    </script>
</body>
</html>
